{% extends "foreground/base.html" %}

{% block head %}
  <link href="/static/libs/editor.md/css/editormd.min.css" rel="stylesheet">
{% endblock %}

{% block content %}
  <div id="article">
    <div class="article-head ml-3">
      <h2>{{ article.title }}</h2>
      <div class="badge badge-light text-right text-secondary">
        <i class="fa fa-clock-o"></i> {{ article.create_time | date:"Y-m-d H:i:s" }}
      </div>
      {% if request.user.is_superuser %}
        <a id="edit" href="{% url 'background:publish' %}?articleId={{ article_id }}" class="text-secondary">
          <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
        </a>
      {% endif %}
    </div>
    <div class="editormd-preview-theme-light d-block">
      <div id="content">
        <textarea style="display:none;">{{ article.content }}</textarea>
      </div>
    </div>
  </div>
{% endblock %}

{% block script %}
  <script src="/static/libs/editor.md/lib/marked.min.js"></script>
  <script src="/static/libs/editor.md/lib/prettify.min.js"></script>
  <script src="/static/libs/editor.md/lib/raphael.min.js"></script>
  <script src="/static/libs/editor.md/lib/underscore.min.js"></script>
  <script src="/static/libs/editor.md/lib/sequence-diagram.min.js"></script>
  <script src="/static/libs/editor.md/lib/flowchart.min.js"></script>
  <script src="/static/libs/editor.md/lib/jquery.flowchart.min.js"></script>
  <script src="/static/libs/editor.md/editormd.js"></script>
  <script>
    let testEditor;
    $(function () {
      testEditor = editormd.markdownToHTML("content", {//注意：这里是上面DIV的id
        htmlDecode: "style,script,iframe",
        emoji: true,
        taskList: true,
        tex: true, // 默认不解析
        flowChart: true, // 默认不解析
        sequenceDiagram: true, // 默认不解析
        codeFold: true,
      });
    })
  </script>
{% endblock %}